<%= javascript_include_tag "restaurants" %>
<script>
  var address = '<%= @restaurant.address %>';

  document.addEventListener("DOMContentLoaded", function(){
      initMap('<%= @restaurant.name %>', <%=@restaurant.latitude%>, <%=@restaurant.longitude%>, '<%= @restaurant.address_1 %>', '<%= @restaurant.city %>', '<%= @restaurant.state %>', '<%= @restaurant.zip_code %>')
  });
</script>

<p id="notice"><%= notice %></p>

<h1><%= @restaurant.name %></h1>

<div id="map">

</div>

<section class='items'>
  <h2>Dishes</h2>

  <% @restaurant.items.each do |item| %>
    <section class='item' id='<%= item.name %>'>
      <p><%= link_to item.name, item_path(item) %></p>
      <p>Average Rating: <%= item.average_rating.round(1) %></p>
      <% if current_user&.default? && current_user.registered == 'true' && current_user.reviewable?(item.id) %>
        <%= link_to "Write a Review", new_default_item_review_path(item) %>
      <% end %>
    </section>
  <% end %>

</section>
  <% if current_user&.default? && current_user.registered == 'true' %>
    <%= link_to "Review a New Item", new_default_restaurant_item_path(@restaurant) %>
  <% end %>
</section>
